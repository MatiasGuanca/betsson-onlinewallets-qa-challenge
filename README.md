ğŸ§¾ Online Wallets â€“ QA Backend Engineer Challenge

This repository contains the full solution for the QA Backend Engineer Technical Challenge, including:

Unit tests for core business logic

API (end-to-end) tests validating the public service contract

Docker-based execution environment

Complete testing strategy and structured commit history

ğŸš€ Project Overview

The Online Wallets service exposes three main wallet operations:

Method	Endpoint	Description
GET	/onlinewallet/balance	Retrieves the current wallet balance
POST	/onlinewallet/deposit	Deposits a specified amount
POST	/onlinewallet/withdraw	Withdraws funds (validating balance)

Both service-level logic and the API behavior were tested to ensure correctness, stability, and predictable outcomes.

ğŸ§ª Testing Strategy

The testing approach covers two independent layers:

1ï¸âƒ£ Unit Tests â€” OnlineWalletService

Frameworks used:

xUnit

FluentAssertions

Moq

ğŸ” What is tested
âœ”ï¸ GetBalanceAsync

Returns 0 when no previous transactions exist

Returns computed balance when a last entry is present

âœ”ï¸ DepositFundsAsync

Throws exception for invalid amounts

Inserts the correct repository entry

Returns the updated balance based on previous state

âœ”ï¸ WithdrawFundsAsync

Throws InsufficientBalanceException on insufficient funds

Inserts a negative entry for withdrawals

Returns the correct updated balance

Mocking (Moq) is used to simulate repository interactions without storing real data.

2ï¸âƒ£ API Tests â€” End-to-End

Frameworks used:

RestSharp

FluentAssertions

System.Text.Json with case-insensitive options

These tests validate the real behavior of the running REST API (via Docker), simulating an external consumer.

ğŸ” What is tested
âœ”ï¸ GET /onlinewallet/balance

Response status = 200 OK

JSON body correctly deserialized ({ "amount": decimal })

âœ”ï¸ POST /onlinewallet/deposit

Returns 200 OK

Response body contains the updated balance

Verified using: initialBalance + depositAmount

âœ”ï¸ POST /onlinewallet/withdraw (valid scenario)

Returns 200 OK

Response body contains updated balance

âœ”ï¸ POST /onlinewallet/withdraw (insufficient funds)

Returns 400 BadRequest

Error is generated by internal exception mapping (SystemController.Error)

All tests interact with the real API, not mocks.

ğŸ§± JSON Handling

ASP.NET Core serializes JSON in camelCase.
To ensure correct deserialization, tests use:

new JsonSerializerOptions { PropertyNameCaseInsensitive = true }


This ensures Amount maps correctly to "amount" in API responses.

ğŸ³ Running the Project with Docker
1. Build the Docker image
docker build -f src/Betsson.OnlineWallets.Web/Dockerfile .

2. Run the container
docker run -p 8080:8080 <image-id>


The Swagger UI will be available at:

http://localhost:8080/swagger/index.html

ğŸ§ª Running All Tests

From the solution root folder:

dotnet test


Expected output:

Passed! - Failed: 0, Passed: X, Total: X

### ğŸ§± Project Structure

```
src/
 â”œâ”€â”€ Betsson.OnlineWallets        # Service layer
 â”œâ”€â”€ Betsson.OnlineWallets.Data   # Repository / database logic
 â””â”€â”€ Betsson.OnlineWallets.Web    # API layer

tests/
 â”œâ”€â”€ Betsson.OnlineWallets.UnitTests   # Unit tests (service logic)
 â””â”€â”€ Betsson.OnlineWallets.ApiTests    # End-to-end API tests
```

### ğŸ“Œ Commit Strategy (Conventional Commits)

Commits follow a clean, progressive structure such as:

```
test: add unit tests for GetBalanceAsync
test: add deposit and withdraw service tests
test(api): add API test project
test(api): implement balance, deposit and withdraw API tests
test(api): fix JSON deserialization and align tests with controller behavior
```

This ensures a clear timeline and professional reviewability.

### ğŸ¯ Final Result

This solution demonstrates:

- âœ”ï¸ Deep understanding of service behavior  
- âœ”ï¸ Strong separation between unit tests and end-to-end tests  
- âœ”ï¸ Proper handling of error scenarios and edge cases  
- âœ”ï¸ Full reproducibility via Docker  
- âœ”ï¸ Use of modern testing tools and practices  
- âœ”ï¸ Clean commit history with automated validation  
